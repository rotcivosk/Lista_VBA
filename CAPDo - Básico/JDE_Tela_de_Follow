
Sub Importar_Follow_JDE()


    
    '---TELA DE FOLLOW----
    
    
    
    Call Abrir_Chrome("http://sahdamvpjde009.sa.mds.honda.com:71/jde/E1Menu.maf?jdeLoginAction=LOGOUT&RENDER_MAFLET=E1Menu")
    Call Login_jde(user, senha)
    Dim dt_ini, dt_fin As String

    '05001 - OP
    ThisWorkbook.Activate
    
    dt_ini = Range("c5").Value
    dt_fin = Range("c6").Value
    
    
    
    
    Sheets("Pedidos emitidos JDE").Activate
    Range(Range("A2"), ActiveCell.SpecialCells(xlLastCell)).ClearContents
    With driver
        .FindElementById("drop_fav_menus").Click
        .FindElementByXPath("//div[3]/div/table/tbody/tr/td[4]/table/tbody/tr/td/table/tbody/tr/td/span").Click
        .FindElementByLinkText("Tela de Follow Pedidos Improdutivos").Click
    End With
    
    Application.Wait (Now + TimeValue("0:00:04"))
    With driver
        .SwitchToFrame 8
        .FindElementById("C0_20", timeout:=10000).Clear
        .FindElementById("C0_20").SendKeys ("OP")
        .FindElementById("C0_26").Clear
        .FindElementById("C0_26").SendKeys ("05001")
        .FindElementById("C0_231").Clear
        .FindElementById("C0_231").SendKeys dt_ini
        .FindElementById("C0_233").Clear
        .FindElementById("C0_233").SendKeys dt_fin
        .FindElementById("hc_Find").Click
    End With
    
    Call carregar_Exportar_JDE
    
    ThisWorkbook.Activate
    Sheets("Temp").Activate
    Call pull_Book1xls
    

    Range(Range("A2"), ActiveCell.SpecialCells(xlLastCell)).Copy
    Sheets("Pedidos Emitidos JDE").Activate
    Range("A2").Select
    ActiveSheet.Paste
    
    
    
    '05998 - OP
    

    With driver
        .FindElementById("C0_26", timeout:=10000).Clear
        .FindElementById("C0_26").SendKeys ("05998")
        .FindElementById("hc_Find").Click
    End With
    Application.Wait (Now + TimeValue("0:00:04"))
    Call carregar_Exportar_JDE
    
    ThisWorkbook.Activate
    Sheets("Temp").Activate
    Call pull_Book1xls
    Call copiar_Temp_para_Pedidos
    
    
    
    '10001 - OP

    With driver
        .FindElementById("C0_26").Clear
        .FindElementById("C0_26").SendKeys ("10001")
        .FindElementById("hc_Find").Click
    End With
    Application.Wait (Now + TimeValue("0:00:10"))
    Call carregar_Exportar_JDE
    
    ThisWorkbook.Activate
    Sheets("Temp").Activate
    Call pull_Book1xls
    Call copiar_Temp_para_Pedidos
    
    
    
    '10998 - OP
    

    With driver
        .FindElementById("C0_26").Clear
        .FindElementById("C0_26").SendKeys ("10998")
        .FindElementById("hc_Find").Click
    End With
    
    Call carregar_Exportar_JDE
    
    ThisWorkbook.Activate
    Sheets("Temp").Activate
    Call pull_Book1xls
    Call copiar_Temp_para_Pedidos
    
    
    '05001 - OL
    

    With driver
        .FindElementById("C0_20").Clear
        .FindElementById("C0_20").SendKeys ("OL")
        .FindElementById("C0_26").Clear
        .FindElementById("C0_26").SendKeys ("05001")
        .FindElementById("hc_Find").Click
    End With
    Application.Wait (Now + TimeValue("0:00:04"))
    Call carregar_Exportar_JDE
    
    ThisWorkbook.Activate
    Sheets("Temp").Activate
    Call pull_Book1xls
    Call copiar_Temp_para_Pedidos
        
    
    '10001 - OL
    

    With driver
        .FindElementById("C0_26").Clear
        .FindElementById("C0_26").SendKeys ("10001")
        .FindElementById("hc_Find").Click
    End With
    Application.Wait (Now + TimeValue("0:00:04"))
    Call carregar_Exportar_JDE
    
    ThisWorkbook.Activate
    Sheets("Temp").Activate
    Call pull_Book1xls
    Call copiar_Temp_para_Pedidos
    
    
    '05001 - OM
    

    With driver
        .FindElementById("C0_20").Clear
        .FindElementById("C0_20").SendKeys ("OM")
        .FindElementById("C0_26").Clear
        .FindElementById("C0_26").SendKeys ("05001")
        .FindElementById("hc_Find").Click
    End With
    Application.Wait (Now + TimeValue("0:00:04"))
    Call carregar_Exportar_JDE
    
    ThisWorkbook.Activate
    Sheets("Temp").Activate
    Call pull_Book1xls
    Call copiar_Temp_para_Pedidos
        
    
    '10001 - OM
    

    With driver
        .FindElementById("C0_26").Clear
        .FindElementById("C0_26").SendKeys ("10001")
        .FindElementById("hc_Find").Click
    End With
    Application.Wait (Now + TimeValue("0:00:04"))
    Call carregar_Exportar_JDE
    
    ThisWorkbook.Activate
    Sheets("Temp").Activate
    Call pull_Book1xls
    Call copiar_Temp_para_Pedidos
    
    '05001 - OS
    

    With driver
        .FindElementById("C0_20").Clear
        .FindElementById("C0_20").SendKeys ("OS")
        .FindElementById("C0_26").Clear
        .FindElementById("C0_26").SendKeys ("05001")
        .FindElementById("hc_Find").Click
    End With
    Application.Wait (Now + TimeValue("0:00:04"))
    Call carregar_Exportar_JDE
    
    ThisWorkbook.Activate
    Sheets("Temp").Activate
    Call pull_Book1xls
    Call copiar_Temp_para_Pedidos
        
    
    '10001 - OS
    

    With driver
        .FindElementById("C0_26").Clear
        .FindElementById("C0_26").SendKeys ("10001")
        .FindElementById("hc_Find").Click
    End With
    Application.Wait (Now + TimeValue("0:00:04"))
    Call carregar_Exportar_JDE
    
    ThisWorkbook.Activate
    Sheets("Temp").Activate
    Call pull_Book1xls
    Call copiar_Temp_para_Pedidos
    
    
    Call fechar_Chrome

    Sheets("Macros").Activate
End Sub
