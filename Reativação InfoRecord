Sub Descancelar_Inforecord()
'
' Ativação de Inforecord nas transações ME15 e ME01
'
call Abrir_SAP

    ' Define lista de Itens a serem reativados
    Dim lista As Range
    Set lista = Range(Range("E10"), Range("E10").End(xlDown))

    ' Abre transação ME15
    session.findById("wnd[0]/tbar[0]/okcd").Text = "me15"
    session.findById("wnd[0]").sendVKey 0


    For Each cell In lista  
      With session

          ' Seleciona o item a ser ativado
          .findById("wnd[0]/usr/ctxtEINA-LIFNR").Text = cell.Offset(0, 1).Value
          .findById("wnd[0]/usr/ctxtEINA-MATNR").Text = cell.Value
          .findById("wnd[0]/usr/ctxtEINE-EKORG").Text = "1500"
          .findById("wnd[0]/usr/ctxtEINE-WERKS").Text = "0212"
          .findById("wnd[0]").sendVKey 0

          ' Flaggar como descancelado
          .findById("wnd[0]/usr/chkEINA-LOEKZ").Selected = False
          .findById("wnd[0]/usr/chkEINE-LOEKZ").Selected = False
          .findById("wnd[0]").sendVKey 11

          ' Selecionar o próximo centro e desflaggar
          .findById("wnd[0]/usr/ctxtEINE-WERKS").Text = "0304"
          .findById("wnd[0]").sendVKey 0
          .findById("wnd[0]/usr/chkEINE-LOEKZ").Selected = False
          .findById("wnd[0]").sendVKey 11
      End With
        
    Next

    ' Sair
    session.findById("wnd[0]").sendVKey 3

End Sub
